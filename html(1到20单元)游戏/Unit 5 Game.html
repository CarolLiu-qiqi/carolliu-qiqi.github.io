<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unit 5 Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <style>
        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        @keyframes slideIn {
            from { transform: translateX(-30px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* åŸºç¡€æ ·å¼ */
        .race-track {
            height: 80px;
            background: linear-gradient(90deg, #f0f0f0 50%, #e8e8e8 50%);
            background-size: 20px 100%;
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.1);
        }
        
        .finish-line {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 8px;
            right: 0;
            background: linear-gradient(0deg, #FFD700 0%, #FFA500 100%);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
            z-index: 10;
        }
        
        .rabbit, .turtle {
            position: absolute;
            width: 55px;
            height: 55px;
            transition: left 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 5;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-size: 24px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .rabbit { 
            bottom: 12px; 
            left: 0; 
            background: linear-gradient(135deg, #FF6B6B 0%, #FF4757 100%);
            color: white;
        }
        
        .turtle { 
            top: 12px; 
            left: 0; 
            background: linear-gradient(135deg, #4ECDC4 0%, #2A9D8F 100%);
            color: white;
        }
        
        .cover {
            background: linear-gradient(135deg, #165DFF 0%, #36CFC9 100%);
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
            overflow: hidden;
        }
        
        .cover::before {
            content: '';
            position: absolute;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
            top: 10%;
            left: 10%;
            animation: float 8s infinite;
        }
        
        .cover::after {
            content: '';
            position: absolute;
            width: 300px;
            height: 300px;
            border-radius: 50%;
            background: rgba(255,255,255,0.05);
            bottom: 10%;
            right: 10%;
            animation: float 10s infinite;
        }
        
        .cover-content {
            text-align: center;
            padding: 2rem;
            z-index: 2;
            animation: slideIn 1s ease-out;
        }
        
        .cover h1 {
            animation: bounce 2s infinite;
            text-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .audio-btn {
            transition: all 0.2s ease;
        }
        
        .audio-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .audio-btn:active {
            transform: scale(0.95);
        }
        
        .music-controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            cursor: pointer;
            z-index: 1000;
            border: 3px solid #165DFF;
            transition: all 0.3s ease;
        }
        
        .music-controls:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.25);
        }
        
        .music-icon {
            color: #165DFF;
            font-size: 24px;
        }
        
        .audio-status {
            position: fixed;
            bottom: 90px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            z-index: 999;
            font-size: 14px;
            display: none;
            animation: slideIn 0.3s ease-out;
        }
        
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
        }
        
        .btn {
            transition: all 0.2s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .progress-indicator {
            height: 4px;
            background: #e0e0e0;
            border-radius: 2px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #165DFF 0%, #36CFC9 100%);
            transition: width 0.5s ease;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <!-- éŸ³é¢‘å…ƒç´  -->
    <audio id="bgMusic" loop>
        <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
    </audio>
    <audio id="wordAudio"></audio>

    <!-- éŸ³é¢‘çŠ¶æ€æç¤º -->
    <div class="audio-status" id="audioStatus"></div>

    <!-- èƒŒæ™¯éŸ³ä¹æ§åˆ¶æŒ‰é’® -->
    <div class="music-controls" onclick="toggleBackgroundMusic()">
        <i id="musicIcon" class="fa fa-music music-icon"></i>
    </div>

    <!-- å°é¢é¡µ -->
    <div id="coverPage" class="cover">
        <div class="cover-content">
            <h1 class="text-5xl md:text-7xl font-bold text-white mb-6 text-center">
                Unit 5 Game
            </h1>
            <p class="text-xl text-white/90 mb-10 text-center max-w-2xl mx-auto">
                é€šè¿‡è¶£å‘³ç«èµ›å­¦ä¹ æ°”è±¡ç›¸å…³è¯æ±‡ï¼ŒæŒ‘æˆ˜è‡ªå·±ï¼Œå‡»è´¥å¯¹æ‰‹ï¼
            </p>
            <button id="startBtn" class="bg-white text-blue-600 px-8 py-4 rounded-xl font-bold text-lg shadow-lg hover:bg-gray-100 transition-all transform hover:scale-105">
                å¼€å§‹æ¸¸æˆ <i class="fa fa-arrow-right ml-2"></i>
            </button>
        </div>
    </div>

    <!-- æ¸¸æˆä¸»åŒºåŸŸ -->
    <div id="gameArea" class="container mx-auto px-4 py-8 max-w-3xl hidden">
        <h1 class="text-2xl font-bold text-blue-600 mb-6 flex items-center">
            <i class="fa fa-book mr-2"></i> Unit 5 è¯æ±‡å­¦ä¹ ç«èµ›
        </h1>
        
        <!-- è¿›åº¦æ¡åŒºåŸŸ -->
        <div class="card p-5 rounded-lg mb-6">
            <div class="flex justify-between mb-3">
                <div class="flex items-center">
                    <div class="w-8 h-8 rounded-full bg-red-500 flex items-center justify-center text-white mr-2">
                        <i class="fa fa-bolt"></i>
                    </div>
                    <div>ä½ çš„è¿›åº¦: <span id="rabbitProgress" class="font-bold">0%</span></div>
                </div>
                <div class="flex items-center">
                    <div class="w-8 h-8 rounded-full bg-green-500 flex items-center justify-center text-white mr-2">
                        <i class="fa fa-shield"></i>
                    </div>
                    <div>å¯¹æ‰‹è¿›åº¦: <span id="turtleProgress" class="font-bold">0%</span></div>
                </div>
            </div>
            <div class="race-track">
                <div class="finish-line"></div>
                <div class="rabbit">
                    <i class="fa fa-bolt"></i>
                </div>
                <div class="turtle">
                    <i class="fa fa-shield"></i>
                </div>
            </div>
        </div>
        
        <!-- è¯æ±‡åŒºåŸŸ -->
        <div class="card p-6 rounded-lg mb-6">
            <div class="flex flex-wrap justify-between items-center mb-4">
                <h2 id="word" class="text-xl font-bold text-blue-600 mb-2 sm:mb-0"></h2>
                <button onclick="pronounceWord()" class="audio-btn p-3 bg-blue-100 rounded-full text-blue-600">
                    <i class="fa fa-volume-up text-lg"></i> å‘éŸ³
                </button>
            </div>
            <p id="phonetic" class="text-gray-500 italic mb-3 border-l-4 border-blue-200 pl-3"></p>
            <p id="definition" class="text-gray-700 mb-6 p-3 bg-gray-50 rounded-lg"></p>
            
            <div class="mb-5">
                <label class="block mb-2 font-medium text-gray-700">è¯·æ‹¼å†™å•è¯ï¼š</label>
                <div class="flex">
                    <input type="text" id="userInput" class="flex-grow p-3 border border-gray-300 rounded-l focus:outline-none focus:ring-2 focus:ring-blue-500" 
                           placeholder="è¾“å…¥å•è¯...">
                    <button onclick="checkAnswer()" class="bg-blue-600 text-white p-3 rounded-r btn">æäº¤</button>
                </div>
                <div id="feedback" class="mt-3 min-h-[24px]"></div>
            </div>
            
            <div id="hint" class="hidden p-3 bg-yellow-50 border-l-4 border-yellow-400 mb-4 rounded-r">
                <p id="hintText" class="text-yellow-700"></p>
            </div>
            
            <div class="flex flex-wrap justify-between gap-2">
                <button onclick="showHint()" class="bg-yellow-500 text-white px-4 py-2 rounded btn">
                    <i class="fa fa-lightbulb-o mr-1"></i> æç¤º
                </button>
                <button id="nextBtn" onclick="nextWord()" 
                        class="bg-gray-300 text-gray-500 px-4 py-2 rounded cursor-not-allowed">
                    ä¸‹ä¸€é¢˜ <i class="fa fa-chevron-right ml-1"></i>
                </button>
            </div>
        </div>
        
        <!-- åº•éƒ¨çŠ¶æ€æ  -->
        <div class="grid grid-cols-3 gap-4 text-center text-sm">
            <div class="bg-white p-3 rounded-lg shadow-sm">
                <p class="text-gray-500">è¿›åº¦</p>
                <p id="progress" class="font-bold text-blue-600">1/30</p>
                <div class="progress-indicator mt-2">
                    <div id="progressBar" class="progress-fill" style="width: 3%"></div>
                </div>
            </div>
            <div class="bg-white p-3 rounded-lg shadow-sm">
                <p class="text-gray-500">æ­£ç¡®</p>
                <p id="score" class="font-bold text-green-600">0</p>
            </div>
            <div class="bg-white p-3 rounded-lg shadow-sm">
                <p class="text-gray-500">å‰©ä½™æ—¶é—´</p>
                <p id="timer" class="font-bold text-orange-600">05:00</p>
            </div>
        </div>
    </div>

    <script>
        // å®Œæ•´è¯æ±‡æ•°æ®
        const vocabulary = [
            { word: "bar", phonetic: "/bÉ‘Ë(r)/", definition: "n.ï¼ˆæ²³å£æˆ–æµ·æ¹¾å…¥å£å¤„çš„ï¼‰æ²™æ´²ï¼Œæµ…æ»©" },
            { word: "barometer", phonetic: "/bÉ™ËˆrÉ’mÉªtÉ™/", definition: "n. æ°”å‹è¡¨ï¼ˆä¹ŸæŒ‡æ°”å‹ï¼‰" },
            { word: "forecast", phonetic: "/ËˆfÉ”ËkÉ‘Ëst/", definition: "n. æ°”è±¡é¢„æŠ¥" },
            { word: "gale warning", phonetic: "/É¡eÉªl ËˆwÉ”ËnÉªÅ‹/", definition: "å¤§é£è­¦æŠ¥" },
            { word: "general situation", phonetic: "/ËˆdÊ’enrÉ™l ËŒsÉªtÊƒuËˆeÉªÊƒn/", definition: "æ°”è±¡å½¢åŠ¿/å¤§åŠ¿" },
            { word: "high water", phonetic: "/haÉª ËˆwÉ”ËtÉ™/", definition: "é«˜æ½®" },
            { word: "hydrology", phonetic: "/haÉªËˆdrÉ’lÉ™dÊ’i/", definition: "n. æ°´æ–‡å­¦ï¼Œæ°´æ–‡æƒ…å†µ" },
            { word: "isolated", phonetic: "/ËˆaÉªsÉ™leÉªtÉªd/", definition: "a. å±€éƒ¨çš„" },
            { word: "low water", phonetic: "/lÉ™ÊŠ ËˆwÉ”ËtÉ™/", definition: "ä½æ½®" },
            { word: "meteorology", phonetic: "/ËŒmiËtiÉ™ËˆrÉ’lÉ™dÊ’i/", definition: "n. æ°”è±¡" },
            { word: "monsoon", phonetic: "/ËŒmÉ’nËˆsuËn/", definition: "n. ä¿¡é£" },
            { word: "scattered", phonetic: "/ËˆskÃ¦tÉ™d/", definition: "a. é›¶æ˜Ÿçš„" },
            { word: "seas/sea state", phonetic: "/siËz/ /siË steÉªt/", definition: "æµªçº§ï¼Œæµ·å†µ" },
            { word: "shower", phonetic: "/ËˆÊƒaÊŠÉ™/", definition: "n. é˜µé›¨" },
            { word: "southwesterly", phonetic: "/saÊŠÎ¸ËˆwestÉ™li/", definition: "a.ï¼ˆé£ï¼‰å‘è¥¿å—çš„ï¼Œæ¥è‡ªè¥¿å—(çš„)" },
            { word: "swell", phonetic: "/swel/", definition: "n. æ¶Œï¼Œæ¶Œæµª" },
            { word: "synoptic", phonetic: "/sÉªËˆnÉ’ptÉªk/", definition: "a. å¤©æ°”çš„ï¼Œæ¦‚è¦çš„" },
            { word: "synoptic situation", phonetic: "/sÉªËˆnÉ’ptÉªk ËŒsÉªtÊƒuËˆeÉªÊƒn/", definition: "æ°”è±¡å½¢åŠ¿/å¤§åŠ¿" },
            { word: "take shelter", phonetic: "/teÉªk ËˆÊƒeltÉ™/", definition: "é¿é£ï¼Œå¯»æ±‚åº‡æŠ¤æ‰€" },
            { word: "thunderstorm", phonetic: "/ËˆÎ¸ÊŒndÉ™stÉ”Ëm/", definition: "n. é›·é›¨" },
            { word: "tide", phonetic: "/taÉªd/", definition: "n. æ½®æ±" },
            { word: "tropical", phonetic: "/ËˆtrÉ’pÉªkl/", definition: "a. çƒ­å¸¦çš„" },
            { word: "tropical storm", phonetic: "/ËˆtrÉ’pÉªkl stÉ”Ëm/", definition: "çƒ­å¸¦é£æš´" },
            { word: "valid", phonetic: "/ËˆvÃ¦lÉªd/", definition: "a. æœ‰æ•ˆçš„" },
            { word: "veer", phonetic: "/vÉªÉ™/", definition: "vt. ä½¿è½¬å‘, æ”¾å‡ºï¼ˆé”šï¼‰ï¼›vi. è½¬å‘ï¼Œï¼ˆé£å‘ï¼‰é¡ºï¼ˆæ—¶é’ˆï¼‰è½¬" },
            { word: "visibility", phonetic: "/ËŒvÉªzÉ™ËˆbÉªlÉ™ti/", definition: "n. èƒ½è§åº¦" },
            { word: "weather message", phonetic: "/ËˆweÃ°É™ ËˆmesÉªdÊ’/", definition: "æ°”è±¡æŠ¥å‘Š" },
            { word: "wind direction", phonetic: "/wÉªnd daÉªËˆrekÊƒn/", definition: "é£å‘" },
            { word: "wind force", phonetic: "/wÉªnd fÉ”Ës/", definition: "é£åŠ›" },
            { word: "WX bulletin", phonetic: "/ËŒdÊŒbljuËËˆeks ËˆbÊŠlÉ™tÉªn/", definition: "æ°”è±¡å…¬æŠ¥" }
        ];

        // æ¸¸æˆçŠ¶æ€
        let currentIndex = 0;
        let shuffledVocab = [];
        let score = 0;
        let timeLeft = 300; // 5åˆ†é’Ÿ
        let rabbitPos = 0;
        let turtlePos = 0;
        let timer;
        let turtleMoveInterval;
        let musicPlaying = false;
        
        // DOMå…ƒç´ 
        const bgMusic = document.getElementById('bgMusic');
        const wordAudio = document.getElementById('wordAudio');
        const coverPage = document.getElementById('coverPage');
        const gameArea = document.getElementById('gameArea');
        const startBtn = document.getElementById('startBtn');
        const musicIcon = document.getElementById('musicIcon');
        const audioStatus = document.getElementById('audioStatus');
        const userInput = document.getElementById('userInput');
        const feedback = document.getElementById('feedback');
        const nextBtn = document.getElementById('nextBtn');
        const wordElement = document.getElementById('word');
        const phoneticElement = document.getElementById('phonetic');
        const definitionElement = document.getElementById('definition');
        const hintElement = document.getElementById('hint');
        const hintTextElement = document.getElementById('hintText');
        const progressElement = document.getElementById('progress');
        const progressBar = document.getElementById('progressBar');
        const scoreElement = document.getElementById('score');
        const timerElement = document.getElementById('timer');
        const rabbitElement = document.querySelector('.rabbit');
        const turtleElement = document.querySelector('.turtle');
        const rabbitProgressElement = document.getElementById('rabbitProgress');
        const turtleProgressElement = document.getElementById('turtleProgress');

        // æ˜¾ç¤ºéŸ³é¢‘çŠ¶æ€æç¤º
        function showAudioStatus(message, duration = 2000) {
            audioStatus.textContent = message;
            audioStatus.style.display = 'block';
            
            clearTimeout(window.audioStatusTimeout);
            window.audioStatusTimeout = setTimeout(() => {
                audioStatus.style.display = 'none';
            }, duration);
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // å¼€å§‹æ¸¸æˆæŒ‰é’®äº‹ä»¶
            startBtn.addEventListener('click', function() {
                coverPage.style.display = 'none';
                gameArea.classList.remove('hidden');
                initGame();
                
                // å°è¯•æ’­æ”¾èƒŒæ™¯éŸ³ä¹
                setTimeout(() => {
                    if (!musicPlaying) {
                        toggleBackgroundMusic();
                    }
                }, 1000);
            });

            // é¢„å…ˆè¯·æ±‚éŸ³é¢‘æƒé™
            document.body.addEventListener('click', function enableAudio() {
                // æ’­æ”¾ä¸€ä¸ªé™éŸ³çš„éŸ³é¢‘æ¥è·å–æƒé™
                const tempAudio = new Audio();
                tempAudio.volume = 0;
                tempAudio.play().catch(e => console.log('éŸ³é¢‘æƒé™è¯·æ±‚:', e));
                document.body.removeEventListener('click', enableAudio);
            });
        });

        // èƒŒæ™¯éŸ³ä¹æ§åˆ¶
        function playBackgroundMusic() {
            bgMusic.volume = 0.3;
            bgMusic.play()
                .then(() => {
                    musicPlaying = true;
                    musicIcon.className = "fa fa-volume-up music-icon";
                    showAudioStatus("èƒŒæ™¯éŸ³ä¹å·²å¼€å¯");
                })
                .catch(error => {
                    console.log('éŸ³ä¹æ’­æ”¾å¤±è´¥:', error);
                    musicIcon.className = "fa fa-volume-off music-icon";
                    showAudioStatus("è¯·å…è®¸ç½‘ç«™æ’­æ”¾å£°éŸ³", 3000);
                });
        }

        function pauseBackgroundMusic() {
            bgMusic.pause();
            musicPlaying = false;
            musicIcon.className = "fa fa-volume-off music-icon";
            showAudioStatus("èƒŒæ™¯éŸ³ä¹å·²å…³é—­");
        }

        function toggleBackgroundMusic() {
            if (musicPlaying) {
                pauseBackgroundMusic();
            } else {
                playBackgroundMusic();
            }
        }

        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            currentIndex = 0;
            // æ‰“ä¹±è¯æ±‡é¡ºåºï¼Œä½†ä¿ç•™æ‰€æœ‰è¯æ±‡
            shuffledVocab = [...vocabulary].sort(() => Math.random() - 0.5);
            score = 0;
            timeLeft = 300;
            rabbitPos = 0;
            turtlePos = 0;
            
            // æ›´æ–°UI
            scoreElement.textContent = score;
            updateTimer();
            loadWord(currentIndex);
            updateRacePositions();
            updateProgressDisplay();
            
            // å¯åŠ¨è®¡æ—¶å™¨
            clearInterval(timer);
            timer = setInterval(updateTime, 1000);
            
            // å¯åŠ¨ä¹Œé¾Ÿç§»åŠ¨
            clearInterval(turtleMoveInterval);
            turtleMoveInterval = setInterval(moveTurtle, 2000);
        }

        // æ›´æ–°è¿›åº¦æ˜¾ç¤º
        function updateProgressDisplay() {
            const progressPercent = ((currentIndex + 1) / shuffledVocab.length) * 100;
            progressElement.textContent = `${currentIndex + 1}/${shuffledVocab.length}`;
            progressBar.style.width = `${progressPercent}%`;
        }

        // åŠ è½½å•è¯
        function loadWord(index) {
            const item = shuffledVocab[index];
            wordElement.textContent = ""; // éšè—å•è¯
            phoneticElement.textContent = item.phonetic;
            definitionElement.textContent = item.definition;
            userInput.value = "";
            feedback.textContent = "";
            hintElement.classList.add('hidden');
            
            // ç¦ç”¨ä¸‹ä¸€é¢˜æŒ‰é’®
            nextBtn.disabled = true;
            nextBtn.className = "bg-gray-300 text-gray-500 px-4 py-2 rounded cursor-not-allowed";
            
            userInput.focus();
        }

        // æ£€æŸ¥ç­”æ¡ˆ
        function checkAnswer() {
            const userAnswer = userInput.value.trim().toLowerCase();
            const correctAnswer = shuffledVocab[currentIndex].word.toLowerCase();
            
            if (userAnswer === correctAnswer) {
                feedback.textContent = "æ­£ç¡®ï¼åšå¾—å¥½ï¼";
                feedback.style.color = "green";
                feedback.style.fontWeight = "bold";
                score++;
                scoreElement.textContent = score;
                
                // æ˜¾ç¤ºæ­£ç¡®å•è¯å¹¶æ·»åŠ åŠ¨ç”»
                wordElement.textContent = shuffledVocab[currentIndex].word;
                wordElement.style.animation = "bounce 0.5s";
                setTimeout(() => {
                    wordElement.style.animation = "";
                }, 500);
                
                // ç§»åŠ¨å…”å­ - æ ¹æ®å•è¯é•¿åº¦è°ƒæ•´ç§»åŠ¨è·ç¦»
                const moveDistance = 3 + Math.min(Math.floor(shuffledVocab[currentIndex].word.length / 2), 4);
                rabbitPos += moveDistance;
                if (rabbitPos > 100) rabbitPos = 100;
                updateRacePositions();
                
                // å¯ç”¨ä¸‹ä¸€é¢˜æŒ‰é’®
                nextBtn.disabled = false;
                nextBtn.className = "bg-green-500 text-white px-4 py-2 rounded btn hover:bg-green-600";
                
                // æ£€æŸ¥æ˜¯å¦åˆ°è¾¾ç»ˆç‚¹
                checkWinner();
            } else {
                feedback.textContent = "ä¸æ­£ç¡®ï¼Œè¯·å†è¯•ä¸€æ¬¡ã€‚";
                feedback.style.color = "red";
                // æ·»åŠ è½»å¾®éœ‡åŠ¨æ•ˆæœ
                userInput.style.animation = "shake 0.3s";
                setTimeout(() => {
                    userInput.style.animation = "";
                }, 300);
            }
        }

        // ä¸‹ä¸€é¢˜
        function nextWord() {
            currentIndex++;
            
            if (currentIndex < shuffledVocab.length) {
                loadWord(currentIndex);
                updateProgressDisplay();
            } else {
                endGame();
            }
        }

        // æ˜¾ç¤ºæç¤º
        function showHint() {
            const word = shuffledVocab[currentIndex].word;
            // æ›´æ™ºèƒ½çš„æç¤º - æ˜¾ç¤ºå•è¯çš„å‰ä¸¤ä¸ªå­—æ¯å’Œé•¿åº¦
            const hintLetters = word.length > 2 ? word.substring(0, 2) + "*".repeat(word.length - 2) : word;
            hintTextElement.textContent = `æç¤º: å•è¯é•¿åº¦ä¸º ${word.length} ä¸ªå­—æ¯ â†’ ${hintLetters}`;
            hintElement.classList.remove('hidden');
        }

        // ç§»åŠ¨ä¹Œé¾Ÿ
        function moveTurtle() {
            // éšæœºç§»åŠ¨è·ç¦»ï¼Œå¢åŠ ä¸ç¡®å®šæ€§
            const moveDistance = 0.5 + Math.random() * 1;
            turtlePos += moveDistance;
            if (turtlePos > 100) turtlePos = 100;
            updateRacePositions();
            checkWinner();
        }

        // æ›´æ–°èµ›è·‘ä½ç½®
        function updateRacePositions() {
            rabbitElement.style.left = `${rabbitPos}%`;
            turtleElement.style.left = `${turtlePos}%`;
            rabbitProgressElement.textContent = `${Math.round(rabbitPos)}%`;
            turtleProgressElement.textContent = `${Math.round(turtlePos)}%`;
            
            // å½“æ¥è¿‘ç»ˆç‚¹æ—¶æ·»åŠ è„‰åŠ¨æ•ˆæœ
            if (rabbitPos > 80) {
                rabbitElement.style.animation = "pulse 1s infinite";
            } else {
                rabbitElement.style.animation = "";
            }
            
            if (turtlePos > 80) {
                turtleElement.style.animation = "pulse 1s infinite";
            } else {
                turtleElement.style.animation = "";
            }
        }

        // æ£€æŸ¥è·èƒœè€…
        function checkWinner() {
            if (rabbitPos >= 100) {
                clearInterval(timer);
                clearInterval(turtleMoveInterval);
                setTimeout(() => {
                    alert(`ğŸ‰ æ­å–œä½ èµ¢äº†ï¼\nå¾—åˆ†: ${score}/${currentIndex + 1}\nç”¨æ—¶: ${5 - Math.floor(timeLeft / 60)}åˆ†${300 - timeLeft % 60}ç§’`);
                    initGame();
                }, 500);
            } else if (turtlePos >= 100) {
                clearInterval(timer);
                clearInterval(turtleMoveInterval);
                setTimeout(() => {
                    alert(`ğŸ˜¢ å¾ˆé—æ†¾ï¼Œå¯¹æ‰‹èµ¢äº†ï¼\nä½ çš„å¾—åˆ†: ${score}/${currentIndex + 1}`);
                    initGame();
                }, 500);
            }
        }

        // æ›´æ–°æ—¶é—´
        function updateTime() {
            timeLeft--;
            updateTimer();
            
            // æ—¶é—´ä¸å¤šæ—¶æ·»åŠ è­¦å‘Šæ•ˆæœ
            if (timeLeft < 60) {
                timerElement.style.color = "red";
                timerElement.style.animation = "pulse 1s infinite";
            } else {
                timerElement.style.color = "";
                timerElement.style.animation = "";
            }
            
            if (timeLeft <= 0) {
                endGame();
            }
        }

        // æ›´æ–°è®¡æ—¶å™¨æ˜¾ç¤º
        function updateTimer() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // ç»“æŸæ¸¸æˆ
        function endGame() {
            clearInterval(timer);
            clearInterval(turtleMoveInterval);
            alert(`â° æ—¶é—´åˆ°ï¼\nä½ çš„å¾—åˆ†: ${score}/${shuffledVocab.length}`);
            initGame();
        }

        // å•è¯å‘éŸ³åŠŸèƒ½ - åŒé‡æœºåˆ¶ç¡®ä¿å…¼å®¹æ€§
        function pronounceWord() {
            const word = shuffledVocab[currentIndex].word;
            const words = word.split(' ');
            showAudioStatus(`æ­£åœ¨æ’­æ”¾: ${word}`);
            
            // ä¿å­˜å½“å‰èƒŒæ™¯éŸ³ä¹éŸ³é‡
            const originalVolume = bgMusic.volume;
            
            // é™ä½èƒŒæ™¯éŸ³ä¹éŸ³é‡
            bgMusic.volume = 0.1;
            
            // æ–¹æ³•1: ä½¿ç”¨Web Speech API
            if ('speechSynthesis' in window) {
                // åœæ­¢ä»»ä½•æ­£åœ¨è¿›è¡Œçš„è¯­éŸ³
                window.speechSynthesis.cancel();
                
                // åˆ›å»ºè¯­éŸ³åˆæˆå®ä¾‹
                const utterance = new SpeechSynthesisUtterance(word);
                utterance.lang = 'en-US';
                utterance.rate = 0.9;
                utterance.pitch = 1.1;
                
                // æ’­æ”¾å®Œæˆåæ¢å¤èƒŒæ™¯éŸ³ä¹éŸ³é‡
                utterance.onend = () => {
                    setTimeout(() => {
                        bgMusic.volume = originalVolume;
                    }, 300);
                };
                
                window.speechSynthesis.speak(utterance);
                return;
            }
            
            // æ–¹æ³•2: ä½¿ç”¨æœ‰é“è¯å…¸API
            if (words.length > 1) {
                // å¤„ç†çŸ­è¯­ï¼Œä¾æ¬¡æ’­æ”¾æ¯ä¸ªå•è¯
                let delay = 0;
                words.forEach((w, index) => {
                    setTimeout(() => {
                        wordAudio.src = `https://dict.youdao.com/dictvoice?type=2&audio=${encodeURIComponent(w)}`;
                        wordAudio.play().catch(e => console.log('å‘éŸ³æ’­æ”¾å¤±è´¥:', e));
                        
                        // æœ€åä¸€ä¸ªå•è¯æ’­æ”¾åæ¢å¤èƒŒæ™¯éŸ³ä¹
                        if (index === words.length - 1) {
                            setTimeout(() => {
                                bgMusic.volume = originalVolume;
                            }, 800);
                        }
                    }, delay);
                    delay += 800; // å•è¯ä¹‹é—´çš„é—´éš”
                });
            } else {
                // å•ä¸ªå•è¯
                wordAudio.src = `https://dict.youdao.com/dictvoice?type=2&audio=${encodeURIComponent(word)}`;
                wordAudio.play()
                    .then(() => {
                        // æ’­æ”¾å®Œæˆåæ¢å¤èƒŒæ™¯éŸ³ä¹éŸ³é‡
                        setTimeout(() => {
                            bgMusic.volume = originalVolume;
                        }, 800);
                    })
                    .catch(e => {
                        console.log('å‘éŸ³æ’­æ”¾å¤±è´¥:', e);
                        showAudioStatus("å‘éŸ³æ’­æ”¾å¤±è´¥", 3000);
                        bgMusic.volume = originalVolume;
                    });
            }
        }

        // é”®ç›˜äº‹ä»¶
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                if (nextBtn.disabled) {
                    checkAnswer();
                } else {
                    nextBtn.click();
                }
            }
        });
    </script>
</body>
</html>
    